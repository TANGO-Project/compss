#!/bin/bash

# Define compiler, libraries, flags, optimizations
export FC=ifort
export FFLAGS="-mcmodel=large -shared-intel -convert big_endian -traceback -assume byterecl -O3 -fp-model precise -fp-stack-check"

echo "--- Building fixed executables-------------"

$FC $FFLAGS -o botsoiltype.x botsoiltype.f90
$FC $FFLAGS -o gfdlco2.x gfdlco2.f  
$FC $FFLAGS -o deeptemperature.x deeptemperature.f90
$FC $FFLAGS -o envelope.x envelope.f90
$FC $FFLAGS -o landuse.x landuse.f90 
$FC $FFLAGS -o landusenew.x landusenew.f90
$FC $FFLAGS -o smmount.x smmount.f90 
$FC $FFLAGS -o roughness.x roughness.f90 
$FC $FFLAGS -o snowalbedo.x snowalbedo.f90
$FC $FFLAGS -o stdh.x stdh.f90
$FC $FFLAGS -o stdhtopo.x stdhtopo.f90
$FC $FFLAGS -o topo.x topo.f90
$FC $FFLAGS -o toposeamask.x toposeamask.f90
$FC $FFLAGS -o topsoiltype.x topsoiltype.f90
$FC $FFLAGS -o vcgenerator.x vcgenerator.f90
#looktables is still generated by the run_aerosol script
echo "--- Finished building fixed executables-------------"

echo "========= BEGIN ==================="
echo ""

echo "---generate DEM height and sea mask files-------------"
./smmount.x

echo "---generate landuse file------------------------------"
./landuse.x

echo "---generate landusenew file---------------------------"
./landusenew.x

echo "---generate mountains---------------------------------"
./topo.x

echo "---generate standard deviation of topography height---"
./stdh.x

echo "---generate envelope mountains------------------------"
./envelope.x

echo "---generate top soil type file------------------------"
./topsoiltype.x

echo "---generate bottom soil type file---------------------"
./botsoiltype.x

echo "---generate sea mask and reprocess mountains----------"
./toposeamask.x

echo "---reprocess standard deviation of topography height--"
./stdhtopo.x

echo "---generate deep soil temperature---------------------"
./deeptemperature.x

echo "---generate maximum snow albedo-----------------------"
./snowalbedo.x

echo "---generate vertical coordinate-----------------------"
./vcgenerator.x

echo "--generate highres roughness length for africa and asia"
./roughness.x

echo "---generate co2 files---------------------------------"
./gfdlco2.x

echo "--generate lookup tables for aerosol scavenging collection efficiencies"
cd lookup_tables
./run_aerosol

rm *.x

echo ""
echo "========== END ===================="

exit

